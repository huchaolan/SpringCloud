# 应用间通信

## HTTP vs RPC

Dubbo(RPC)
RPC框架，在服务间集成治理上非常完善，不仅提供了服务注册发现，负载均衡和路由等面向分布式集成的基础能力，还设计了面向开发测试阶段的mock，同时提供监控和可视平台
SpringCloud(HTTP)
微服务架构下的一战式解决方案。

### SpringCloud中服务间两种restful调用方式

+ RestTemplate
+ Feign

#### RestTemplate

RestTemplate有3中方式

1. 直接使用服务地址url方式，这个是一个初级方案
2. 使用`org.springframework.cloud.client.loadbalancer.LoadBalancerClient`实现获取指定服务的ServiceInstance对象。由这个对象获取调用服务的机器名和端口号
3. 使用@LoadBalanced注解，加在使用java配置Bean的时候，后续通过spring容器构造的RestTemplate(Autowired)会具有负载均衡的能力

```java
@Bean
@LoadBalanced
public RestTemplate restTemplate(){
    RestTemplate rest = new RestTemplate();
    return rest;
}
```

```java
restTemplate.getForObject(new URI("http://PRODUCT/product/getProductInfo"), String.class);
```

注意PRODUCT只是一个微服务的名称，springcloud会自动查询微服务对应的信息，但是又不暴露在外面并且又负载均衡的作用